import"../chunks/Bzak7iHL.js";import"../chunks/69_IOA4Y.js";import{o as T}from"../chunks/bhRhCqWC.js";import{p as x,b as $,s as h,f as P,a as w,d as S,e as A,r as C,t as N}from"../chunks/CnxLOvM0.js";import{s as O}from"../chunks/BFpeZ14H.js";import{i as J,s as I,a as d}from"../chunks/DulKp6NI.js";import{i as L}from"../chunks/C-D-gK8t.js";import{D as M}from"../chunks/mGQo6xjj.js";import{w as m}from"../chunks/5VKP8Fpw.js";var U=$('<p style="color: red"> </p>'),q=$("<h1>Клавиатуры</h1> <!> <!>",1);function X(y,g){x(g,!1);const[i,_]=I(),p=()=>d(a,"$apiError",i),v=()=>d(c,"$documents",i),D=()=>d(l,"$loadingDocuments",i),r="keyboards",c=m([]),l=m(!1),a=m(null);async function n(){l.set(!0),a.set(null);try{const t=await fetch(`/api/${r}`);if(!t.ok){const o=await t.json();throw new Error(o.error||"Failed to fetch documents")}const e=await t.json();c.set(e)}catch(t){a.set(t.message),c.set([])}finally{l.set(!1)}}async function E(t){a.set(null);try{const e=`/api/${r}/${t._id}`,o=await fetch(e,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!o.ok){const s=await o.json();throw new Error(s.error||"Failed to save document")}await n()}catch(e){a.set(e.message)}}async function b(t){a.set(null);try{const e=`/api/${r}`,o=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!o.ok){const s=await o.json();throw new Error(s.error||"Failed to add document")}await n()}catch(e){a.set(e.message)}}async function j(t){a.set(null);try{const e=`/api/${r}/${t._id}`,o=await fetch(e,{method:"DELETE"});if(!o.ok){const s=await o.json();throw new Error(s.error||"Failed to delete document")}await n()}catch(e){a.set(e.message)}}T(()=>{n()}),L();var f=q(),u=h(P(f),2);{var k=t=>{var e=U(),o=A(e);C(e),N(()=>O(o,`Ошибка API: ${p()??""}`)),w(t,e)};J(u,t=>{p()&&t(k)})}var F=h(u,2);M(F,{get documents(){return v()},get loading(){return D()},selectedCollection:r,orderFields:["name","text","keyboard_name","images","created_at","_id"],$$events:{save:t=>E(t.detail),add:t=>b(t.detail),delete:t=>j(t.detail)}}),w(y,f),S(),_()}export{X as component};
