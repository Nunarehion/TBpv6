import"../chunks/Bzak7iHL.js";import"../chunks/69_IOA4Y.js";import{o as O}from"../chunks/bhRhCqWC.js";import{p as P,b as g,s as h,f as S,a as w,d as A,e as C,r as N,t as J}from"../chunks/CnxLOvM0.js";import{s as M}from"../chunks/BFpeZ14H.js";import{i as I,s as L,a as d}from"../chunks/DulKp6NI.js";import{i as R}from"../chunks/C-D-gK8t.js";import{D as U}from"../chunks/mGQo6xjj.js";import{w as m}from"../chunks/5VKP8Fpw.js";var q=g('<p style="color: red"> </p>'),z=g("<h1>Сообщения</h1> <!> <!>",1);function Z(y,$){P($,!1);const[i,_]=L(),p=()=>d(a,"$apiError",i),v=()=>d(c,"$documents",i),D=()=>d(l,"$loadingDocuments",i),r="message",c=m([]),l=m(!1),a=m(null),E=["name","_id","text","keyboard_name","images"],b=["name","text","keyboard_name","images","created_at","_id"];async function n(){l.set(!0),a.set(null);try{const e=await fetch(`/api/${r}`);if(!e.ok){const o=await e.json();throw new Error(o.error||"Failed to fetch documents")}const t=await e.json();c.set(t)}catch(e){a.set(e.message),c.set([])}finally{l.set(!1)}}async function j(e){a.set(null);try{const t=`/api/${r}/${e._id}`,o=await fetch(t,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!o.ok){const s=await o.json();throw new Error(s.error||"Failed to save document")}await n()}catch(t){a.set(t.message)}}async function k(e){a.set(null);try{const t=`/api/${r}`,o=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!o.ok){const s=await o.json();throw new Error(s.error||"Failed to add document")}await n()}catch(t){a.set(t.message)}}async function F(e){a.set(null);try{const t=`/api/${r}/${e._id}`,o=await fetch(t,{method:"DELETE"});if(!o.ok){const s=await o.json();throw new Error(s.error||"Failed to delete document")}await n()}catch(t){a.set(t.message)}}O(()=>{n()}),R();var f=z(),u=h(S(f),2);{var T=e=>{var t=q(),o=C(t);N(t),J(()=>M(o,`Ошибка API: ${p()??""}`)),w(e,t)};I(u,e=>{p()&&e(T)})}var x=h(u,2);U(x,{get documents(){return v()},get loading(){return D()},selectedCollection:r,isMessageRoute:!0,get displayFields(){return E},get orderFields(){return b},$$events:{save:e=>j(e.detail),add:e=>k(e.detail),delete:e=>F(e.detail)}}),w(y,f),A(),_()}export{Z as component};
