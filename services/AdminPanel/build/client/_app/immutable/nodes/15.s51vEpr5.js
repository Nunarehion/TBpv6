import"../chunks/Bzak7iHL.js";import"../chunks/69_IOA4Y.js";import{o as F}from"../chunks/bhRhCqWC.js";import{p as P,b as $,s as h,f as S,a as w,d as x,e as A,r as C,t as N}from"../chunks/CnxLOvM0.js";import{s as O}from"../chunks/BFpeZ14H.js";import{i as J,s as I,a as d}from"../chunks/DulKp6NI.js";import{i as L}from"../chunks/C-D-gK8t.js";import{D as M}from"../chunks/mGQo6xjj.js";import{w as m}from"../chunks/5VKP8Fpw.js";var U=$('<p style="color: red"> </p>'),q=$("<h1>Пользователи</h1> <!> <!>",1);function X(g,y){P(y,!1);const[i,v]=I(),p=()=>d(r,"$apiError",i),D=()=>d(c,"$documents",i),_=()=>d(l,"$loadingDocuments",i),a="users",c=m([]),l=m(!1),r=m(null);async function n(){l.set(!0),r.set(null);try{const t=await fetch(`/api/${a}`);if(!t.ok){const o=await t.json();throw new Error(o.error||"Failed to fetch documents")}const e=await t.json();c.set(e)}catch(t){r.set(t.message),c.set([])}finally{l.set(!1)}}async function E(t){r.set(null);try{const e=`/api/${a}/${t._id}`,o=await fetch(e,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!o.ok){const s=await o.json();throw new Error(s.error||"Failed to save document")}await n()}catch(e){r.set(e.message)}}async function j(t){r.set(null);try{const e=`/api/${a}`,o=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!o.ok){const s=await o.json();throw new Error(s.error||"Failed to add document")}await n()}catch(e){r.set(e.message)}}async function b(t){r.set(null);try{const e=`/api/${a}/${t._id}`,o=await fetch(e,{method:"DELETE"});if(!o.ok){const s=await o.json();throw new Error(s.error||"Failed to delete document")}await n()}catch(e){r.set(e.message)}}F(()=>{n()}),L();var f=q(),u=h(S(f),2);{var k=t=>{var e=U(),o=A(e);C(e),N(()=>O(o,`Ошибка API: ${p()??""}`)),w(t,e)};J(u,t=>{p()&&t(k)})}var T=h(u,2);M(T,{get documents(){return D()},get loading(){return _()},selectedCollection:a,$$events:{save:t=>E(t.detail),add:t=>j(t.detail),delete:t=>b(t.detail)}}),w(g,f),x(),v()}export{X as component};
