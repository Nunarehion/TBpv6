import"../chunks/Bzak7iHL.js";import"../chunks/69_IOA4Y.js";import{o as T}from"../chunks/bhRhCqWC.js";import{p as P,b as $,s as h,f as S,a as w,d as x,e as A,r as C,t as N}from"../chunks/CnxLOvM0.js";import{s as O}from"../chunks/BFpeZ14H.js";import{i as J,s as I,a as d}from"../chunks/DulKp6NI.js";import{i as L}from"../chunks/C-D-gK8t.js";import{D as M}from"../chunks/mGQo6xjj.js";import{w as m}from"../chunks/5VKP8Fpw.js";var U=$('<p style="color: red"> </p>'),q=$("<h1>Переменные</h1> <!> <!>",1);function X(v,y){P(y,!1);const[i,g]=I(),p=()=>d(a,"$apiError",i),_=()=>d(c,"$documents",i),D=()=>d(l,"$loadingDocuments",i),s="variables",c=m([]),l=m(!1),a=m(null);async function n(){l.set(!0),a.set(null);try{const e=await fetch(`/api/${s}`);if(!e.ok){const o=await e.json();throw new Error(o.error||"Failed to fetch documents")}const t=await e.json();c.set(t)}catch(e){a.set(e.message),c.set([])}finally{l.set(!1)}}async function E(e){a.set(null);try{const t=`/api/${s}/${e._id}`,o=await fetch(t,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!o.ok){const r=await o.json();throw new Error(r.error||"Failed to save document")}await n()}catch(t){a.set(t.message)}}async function b(e){a.set(null);try{const t=`/api/${s}`,o=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!o.ok){const r=await o.json();throw new Error(r.error||"Failed to add document")}await n()}catch(t){a.set(t.message)}}async function j(e){a.set(null);try{const t=`/api/${s}/${e._id}`,o=await fetch(t,{method:"DELETE"});if(!o.ok){const r=await o.json();throw new Error(r.error||"Failed to delete document")}await n()}catch(t){a.set(t.message)}}T(()=>{n()}),L();var u=q(),f=h(S(u),2);{var F=e=>{var t=U(),o=A(t);C(t),N(()=>O(o,`Ошибка API: ${p()??""}`)),w(e,t)};J(f,e=>{p()&&e(F)})}var k=h(f,2);M(k,{get documents(){return _()},get loading(){return D()},displayFields:["_id","name","value","description"],selectedCollection:["_id","name","value","description"],orderFields:["_id","name","value","description"],$$events:{save:e=>E(e.detail),add:e=>b(e.detail),delete:e=>j(e.detail)}}),w(v,u),x(),g()}export{X as component};
